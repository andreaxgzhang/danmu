<div id="create-message">
  <%= simple_form_for [ @slide, Comment.new ], remote: true do |f| %>
    <%= f.input :content, label: false  %>
    <%= f.input :color, :collection => %w[white black yellow orange pink red purple blue green olive maroon] %>
    <%= f.submit "Add a new comment" %>
  <% end %>
</div>
<div class="comments-show">
  <% @comments.each do |comment| %>
    <% if comment.approved == false %>
      <%= comment.content %>
      <%= button_to "Approve",  slide_comment_path(@slide, comment), params: { approved: true }, method: :put %>
      <%= button_to "Reject", slide_comment_path(@slide, comment), method: :delete %>
     <br>
    <% end %>
  <% end %>
</div>

<% content_for :after_js do %>
  <script>
    App['slide_<%= @slide.id %>'] = App.cable.subscriptions.create(
      { channel: 'SlidesChannel', slide_id: <%= @slide.id %> },
      { received: (data) => {

        const commentContainer = document.querySelector('.comments-show');
        let node = document.createElement("div");
        node.innerHTML = data.comment_partial;
        // commentContainer.insertAdjacentHTML('afterbegin', data.comment_partial);
        // node.style.position = "absolute";
        commentContainer.appendChild(node);
      }
    })
  </script>
<% end %>
